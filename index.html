<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting You...</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        /*
        ========================================
        CSS
        ========================================
        */
        :root {
            --main-color: #3b5998; /* الأزرق الاحترافي */
            --background-color: #1a1a1a; /* خلفية داكنة */
            --text-color: #f0f0f0; /* نص فاتح */
            --highlight-color: #4CAF50; /* الأخضر لكلمة survey */
            --accent-color: #ffeb3b; /* اللكنة الصفراء */
        }

        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: Arial, sans-serif;
            overflow: hidden;
            letter-spacing: 0.5px;
            perspective: 1000px; /* لتمكين الـ 3D */
        }

        /* 1. قسم الرسالة (Message Section) */
        #redirect-container {
            text-align: center;
            z-index: 10;
            position: relative;
            margin-bottom: 40px;
            /* الوضع الأولي للظهور: مرئي */
            opacity: 1; 
        }

        #message {
            font-size: 3em; 
            font-weight: 300;
            line-height: 1.2;
        }

        .highlight {
            color: var(--highlight-color); 
            font-weight: 700;
        }
        
        /* 2. قسم العداد (Countdown Section) */
        #countdown-container {
            position: relative;
            z-index: 15;
            height: 150px; 
            /* هام: إخفاء العداد في الـ CSS لعدم إرباك المستخدم */
            opacity: 0; 
        }

        #countdown-number {
            font-size: 10em; 
            font-weight: 900;
            color: var(--accent-color);
            margin: 0;
            padding: 0;
            /* تأثير 3D */
            text-shadow: 
                0 0 10px rgba(255, 255, 0, 0.5), 
                0 0 20px rgba(255, 255, 0, 0.3);
            /* هام: ابدأ بتحويل بسيط لـ GSAP */
            transform: scale(1);
        }

        /* 3. طبقة الانتقال (Transition Layer) */
        #transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--main-color);
            z-index: 20;
            transform: scaleY(0); 
            transform-origin: bottom;
        }
    </style>
</head>
<body>

    <div id="redirect-container">
        <p id="message" class="loading-animation">
            You are being redirected to the <span class="highlight">survey</span> page... Be Ready...
        </p>
    </div>

    <div id="countdown-container">
        <p id="countdown-number">3</p>
    </div>

    <div id="transition-overlay"></div>

    <script>
        /*
        ========================================
        JavaScript (GSAP Animation)
        ========================================
        */
        document.addEventListener('DOMContentLoaded', () => {
            const messageElement = document.getElementById('message');
            const countdownContainer = document.getElementById('countdown-container');
            const countdownNumber = document.getElementById('countdown-number');
            const overlayElement = document.getElementById('transition-overlay');
            const redirectURL = "https://smrturl.co/27b2e64";
            
            // تحقق من تحميل GSAP
            if (window.gsap) {
                
                const timeline = gsap.timeline({
                    defaults: { ease: "power2.out" },
                    onComplete: () => {
                        // 4. التحويل بعد اكتمال التحريك
                        window.location.href = redirectURL;
                    }
                });

                // 1. انيميشن "جاري التحميل" الاحترافي (ظهور الرسالة وتلاشيها)
                
                // ابدأ الرسالة مخفية (من الأسفل والشفافية 0)
                timeline.from(messageElement, {
                    opacity: 0,
                    y: 30,
                    duration: 0.8,
                    ease: "back.out(1.2)"
                }, 0.2); // تظهر بعد 0.2 ثانية

                // تأثير "نبض/وميض" بسيط للرسالة
                timeline.to(messageElement, {
                    opacity: 0.8,
                    y: -10,
                    duration: 0.3,
                    repeat: 1, // نبضة واحدة
                    yoyo: true,
                    ease: "power1.inOut"
                }, ">+1.0"); // انتظر 1 ثانية بعد الظهور الكامل

                // 2. العداد الدرامي (3, 2, 1)

                // إخفاء الرسالة قبل ظهور العداد
                timeline.to(messageElement, {
                    opacity: 0,
                    y: -50,
                    duration: 0.4,
                    ease: "power2.in"
                }, "+=0.5"); // بعد النبض

                // إظهار حاوية العداد لأول مرة
                timeline.to(countdownContainer, { 
                    opacity: 1,
                    duration: 0.3
                }, "<"); // يبدأ في نفس توقيت اختفاء الرسالة

                // دالة التحديث والتحريك ثلاثي الأبعاد
                const updateCountdown = (number) => {
                    // حركة خروج الرقم الحالي (Scale down and rotate)
                    timeline.to(countdownNumber, {
                        opacity: 0, 
                        scale: 0.7, 
                        rotationX: -90, 
                        duration: 0.2,
                        ease: "power1.in"
                    }, "+=0.8"); // مدة ظهور كل رقم 1 ثانية (0.8 انتظار + 0.2 اختفاء)

                    // تغيير قيمة الرقم
                    timeline.call(() => {
                        countdownNumber.textContent = number; 
                    }, null, "<"); // يتغير في نفس توقيت حركة الخروج

                    // حركة دخول الرقم الجديد (Pop-up 3D)
                    timeline.fromTo(countdownNumber, 
                        { opacity: 0, scale: 0.7, rotationX: 90 },
                        { 
                            opacity: 1, 
                            scale: 1, 
                            rotationX: 0, 
                            duration: 0.4,
                            ease: "back.out(1.7)" // تأثير انبثاق قوي
                        }, "<0.1"); // يبدأ بعد 0.1 ثانية من حركة الخروج
                };

                // تسلسل العداد: 3 -> 2 -> 1
                // (الرقم 3 يظهر تلقائياً مع أول حركة دخول)
                updateCountdown(2); 
                updateCountdown(1);

                // 3. التحويل النهائي (Transition Wipe)
                timeline.to(overlayElement, {
                    scaleY: 1, 
                    transformOrigin: "bottom",
                    duration: 0.8,
                    ease: "power4.inOut"
                }, "+=1.0"); // انتظر 1 ثانية بعد ظهور الرقم "1"

                
            } else {
                // FALLBACK: إذا فشلت GSAP، يتم إظهار الرسالة والتحويل بعد 4 ثوانٍ
                gsap.set(countdownContainer, { opacity: 0 }); // إخفاء العداد إذا فشل GSAP
                setTimeout(() => {
                    window.location.href = redirectURL;
                }, 4000);
            }
        });
    </script>
</body>
</html>
